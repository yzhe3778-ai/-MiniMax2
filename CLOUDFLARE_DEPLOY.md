# â˜ï¸ Cloudflare Pages éƒ¨ç½²æŒ‡å—

## ğŸ“‹ Cloudflare Pages é…ç½®

### âœ… æ­£ç¡®çš„é…ç½®å‚æ•°

åœ¨ Cloudflare Pages è®¾ç½®é¡µé¢å¡«å†™ï¼š

#### 1ï¸âƒ£ åŸºæœ¬è®¾ç½®
```
é¡¹ç›®åç§°: minimax2
ç”Ÿäº§åˆ†æ”¯: master
```

#### 2ï¸âƒ£ æ„å»ºè®¾ç½®
```
æ¡†æ¶é¢„è®¾: Next.js

æ„å»ºå‘½ä»¤: npx @cloudflare/next-on-pages

æ„å»ºè¾“å‡ºç›®å½•: .vercel/output/static

æ ¹ç›®å½•: /ï¼ˆä¿æŒé»˜è®¤ï¼‰
```

#### 3ï¸âƒ£ ç¯å¢ƒå˜é‡
ç‚¹å‡»"æ·»åŠ å˜é‡"ï¼Œæ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
NODE_VERSION = 18
MINIMAX_API_KEY = ä½ çš„MiniMax APIå¯†é’¥
```

**å¯é€‰ç¯å¢ƒå˜é‡**ï¼ˆå¦‚æœä½ é…ç½®äº†é‚®ä»¶æœåŠ¡ï¼‰ï¼š
```
GMAIL_USER = le2932169@gmail.com
GMAIL_APP_PASSWORD = ä½ çš„Gmailåº”ç”¨ä¸“ç”¨å¯†ç 
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£…ä¾èµ–

åœ¨æœ¬åœ°é¡¹ç›®ä¸­è¿è¡Œï¼š

```bash
npm install
```

è¿™ä¼šå®‰è£…æ–°æ·»åŠ çš„ Cloudflare é€‚é…å™¨ã€‚

### æ­¥éª¤ 2: æäº¤æ›´æ”¹åˆ° GitHub

```bash
git add .
git commit -m "feat: æ·»åŠ  Cloudflare Pages éƒ¨ç½²é…ç½®"
git push origin master
```

### æ­¥éª¤ 3: åœ¨ Cloudflare ä¸­é…ç½®

1. è®¿é—® Cloudflare Pages æ§åˆ¶å°
2. é€‰æ‹©ä½ çš„é¡¹ç›® `minimax2`
3. è¿›å…¥ **è®¾ç½® â†’ æ„å»ºå’Œéƒ¨ç½²**
4. æŒ‰ç…§ä¸Šé¢çš„é…ç½®å¡«å†™

### æ­¥éª¤ 4: æ·»åŠ ç¯å¢ƒå˜é‡

1. è¿›å…¥ **è®¾ç½® â†’ ç¯å¢ƒå˜é‡**
2. ç‚¹å‡» **æ·»åŠ å˜é‡**
3. æ·»åŠ ï¼š
   - `NODE_VERSION` = `18`
   - `MINIMAX_API_KEY` = `ä½ çš„å¯†é’¥`

### æ­¥éª¤ 5: è§¦å‘éƒ¨ç½²

1. è¿›å…¥ **éƒ¨ç½²** æ ‡ç­¾
2. ç‚¹å‡» **é‡è¯•éƒ¨ç½²** æˆ–æ¨é€æ–°çš„æäº¤

## ğŸ“Š é…ç½®è¯¦è§£

### ä¸ºä»€ä¹ˆä½¿ç”¨è¿™äº›é…ç½®ï¼Ÿ

#### `npx @cloudflare/next-on-pages`
- è¿™æ˜¯ Cloudflare å®˜æ–¹çš„ Next.js é€‚é…å™¨
- å°† Next.js åº”ç”¨è½¬æ¢ä¸º Cloudflare Workers å…¼å®¹æ ¼å¼
- æ”¯æŒ API è·¯ç”±ã€æœåŠ¡ç«¯æ¸²æŸ“ç­‰åŠŸèƒ½

#### `.vercel/output/static`
- è¿™æ˜¯é€‚é…å™¨çš„è¾“å‡ºç›®å½•
- åŒ…å«ç¼–è¯‘åçš„é™æ€èµ„æºå’Œ Worker è„šæœ¬
- Cloudflare Pages ä¼šä»è¿™ä¸ªç›®å½•éƒ¨ç½²

#### `NODE_VERSION = 18`
- æŒ‡å®š Node.js ç‰ˆæœ¬
- Next.js 15 éœ€è¦ Node.js 18+
- ç¡®ä¿æ„å»ºç¯å¢ƒå…¼å®¹

## âš™ï¸ æœ¬åœ°æµ‹è¯•

åœ¨æ¨é€åˆ° Cloudflare ä¹‹å‰ï¼Œå¯ä»¥æœ¬åœ°æµ‹è¯•ï¼š

```bash
# æ„å»º Cloudflare ç‰ˆæœ¬
npm run pages:build

# æœ¬åœ°é¢„è§ˆï¼ˆéœ€è¦å®‰è£… wranglerï¼‰
npm run preview
```

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Edge Runtime é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Please make sure that all your non-static routes export the following edge runtime route segment config:
export const runtime = 'edge';
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
å·²åœ¨æ‰€æœ‰ API è·¯ç”±ä¸­æ·»åŠ  `export const runtime = 'edge';`

æ‰€æœ‰ API è·¯ç”±æ–‡ä»¶éƒ½å·²é…ç½®ï¼š
- âœ… `app/api/feedback/route.ts`
- âœ… `app/api/hailuo23/generate/route.ts`
- âœ… `app/api/hailuo23/status/route.ts`
- âœ… `app/api/minimaxm2/route.ts`
- âœ… `app/api/generate-image/route.ts`
- âœ… `app/api/generate-video/route.ts`

### é—®é¢˜ 2: æ„å»ºå¤±è´¥ - "Module not found"

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# åˆ é™¤ node_modules å’Œ lock æ–‡ä»¶
rm -rf node_modules package-lock.json

# é‡æ–°å®‰è£…
npm install

# æäº¤å¹¶æ¨é€
git add package-lock.json
git commit -m "fix: æ›´æ–°ä¾èµ–"
git push
```

### é—®é¢˜ 2: API è·¯ç”±è¿”å› 404

**åŸå› **ï¼šCloudflare Pages éœ€è¦ç‰¹æ®Šé…ç½®æ‰èƒ½æ”¯æŒ API è·¯ç”±

**è§£å†³æ–¹æ¡ˆ**ï¼š
ç¡®ä¿ä½¿ç”¨äº† `@cloudflare/next-on-pages` é€‚é…å™¨ï¼Œå·²åœ¨é…ç½®ä¸­æ·»åŠ ã€‚

### é—®é¢˜ 3: ç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤åœ¨ Cloudflare Pages è®¾ç½®ä¸­æ·»åŠ äº†ç¯å¢ƒå˜é‡
2. é‡æ–°éƒ¨ç½²é¡¹ç›®ï¼ˆç¯å¢ƒå˜é‡æ›´æ”¹åéœ€è¦é‡æ–°éƒ¨ç½²ï¼‰
3. æ£€æŸ¥å˜é‡åæ˜¯å¦æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰

### é—®é¢˜ 4: å›¾ç‰‡ä¸æ˜¾ç¤º

**åŸå› **ï¼šCloudflare ä¸æ”¯æŒ Next.js Image Optimization

**è§£å†³æ–¹æ¡ˆ**ï¼š
å·²åœ¨ `next.config.ts` ä¸­è®¾ç½® `images.unoptimized = true`

### é—®é¢˜ 5: æ„å»ºè¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ä¾èµ–æ˜¯å¦è¿‡å¤§
2. è€ƒè™‘ä½¿ç”¨ `.npmrc` é…ç½®åŠ é€Ÿå®‰è£…
3. ç§»é™¤ä¸å¿…è¦çš„ä¾èµ–

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰ç¡®è®¤ï¼š

- [ ] `package.json` å·²æ›´æ–°ï¼ˆåŒ…å« Cloudflare é€‚é…å™¨ï¼‰
- [ ] `next.config.ts` å·²é…ç½®ï¼ˆimages.unoptimizedï¼‰
- [ ] ä»£ç å·²æäº¤åˆ° GitHub
- [ ] Cloudflare Pages æ„å»ºé…ç½®æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡å·²æ·»åŠ 
- [ ] `NODE_VERSION = 18` å·²è®¾ç½®

## ğŸ¯ é¢„æœŸç»“æœ

éƒ¨ç½²æˆåŠŸåï¼š

1. âœ… ä¸»é¡µæ­£å¸¸æ˜¾ç¤º
2. âœ… æ‰€æœ‰åŠŸèƒ½é¡µé¢å¯è®¿é—®
3. âœ… API è·¯ç”±æ­£å¸¸å·¥ä½œ
4. âœ… è§†é¢‘ç”ŸæˆåŠŸèƒ½å¯ç”¨
5. âœ… åé¦ˆè¡¨å•å¯æäº¤

## ğŸŒ è®¿é—®ä½ çš„ç½‘ç«™

éƒ¨ç½²æˆåŠŸåï¼ŒCloudflare ä¼šæä¾›ä¸€ä¸ªåŸŸåï¼š

```
https://minimax2.pages.dev
```

ä½ ä¹Ÿå¯ä»¥ç»‘å®šè‡ªå®šä¹‰åŸŸåï¼š
1. è¿›å…¥ **è‡ªå®šä¹‰åŸŸ**
2. ç‚¹å‡» **è®¾ç½®è‡ªå®šä¹‰åŸŸ**
3. è¾“å…¥ä½ çš„åŸŸåå¹¶æŒ‰ç…§è¯´æ˜é…ç½® DNS

## ğŸ”„ è‡ªåŠ¨éƒ¨ç½²

é…ç½®å®Œæˆåï¼Œæ¯æ¬¡æ¨é€åˆ° `master` åˆ†æ”¯éƒ½ä¼šè‡ªåŠ¨è§¦å‘éƒ¨ç½²ï¼š

```bash
git add .
git commit -m "æ›´æ–°å†…å®¹"
git push origin master
```

Cloudflare ä¼šè‡ªåŠ¨ï¼š
1. æ‹‰å–æœ€æ–°ä»£ç 
2. å®‰è£…ä¾èµ–
3. è¿è¡Œæ„å»ºå‘½ä»¤
4. éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¯ç”¨ Cloudflare CDN
- è‡ªåŠ¨å¯ç”¨ï¼Œå…¨çƒåŠ é€Ÿ

### 2. é…ç½®ç¼“å­˜è§„åˆ™
åœ¨ Cloudflare æ§åˆ¶å°ï¼š
- **è§„åˆ™ â†’ é¡µé¢è§„åˆ™**
- ä¸ºé™æ€èµ„æºè®¾ç½®ç¼“å­˜

### 3. å¯ç”¨ Brotli å‹ç¼©
- **é€Ÿåº¦ â†’ ä¼˜åŒ–**
- å¯ç”¨ Brotli å‹ç¼©

### 4. ä½¿ç”¨ Cloudflare Analytics
- ç›‘æ§ç½‘ç«™æ€§èƒ½
- æŸ¥çœ‹è®¿é—®ç»Ÿè®¡

## ğŸ†š Cloudflare vs Vercel

| ç‰¹æ€§ | Cloudflare Pages | Vercel |
|------|-----------------|--------|
| **Next.js æ”¯æŒ** | éœ€è¦é€‚é…å™¨ | åŸç”Ÿæ”¯æŒ â­ |
| **API è·¯ç”±** | æ”¯æŒï¼ˆé€šè¿‡ Workersï¼‰ | å®Œç¾æ”¯æŒ â­ |
| **éƒ¨ç½²é€Ÿåº¦** | å¿« | éå¸¸å¿« â­ |
| **å…è´¹é¢åº¦** | æ— é™è¯·æ±‚ â­ | 100GB å¸¦å®½ |
| **å…¨çƒ CDN** | ä¼˜ç§€ â­ | ä¼˜ç§€ â­ |
| **é…ç½®å¤æ‚åº¦** | ä¸­ç­‰ | ç®€å• â­ |

**å»ºè®®**ï¼š
- å¦‚æœè¿½æ±‚æœ€ç®€å•çš„éƒ¨ç½²ï¼šä½¿ç”¨ **Vercel**
- å¦‚æœéœ€è¦æ›´å¤šå…è´¹é¢åº¦ï¼šä½¿ç”¨ **Cloudflare Pages**

## ğŸ”— ç›¸å…³èµ„æº

- [Cloudflare Pages æ–‡æ¡£](https://developers.cloudflare.com/pages/)
- [Next.js on Cloudflare Pages](https://developers.cloudflare.com/pages/framework-guides/nextjs/)
- [@cloudflare/next-on-pages](https://github.com/cloudflare/next-on-pages)

## ğŸ’¡ æç¤º

1. **é¦–æ¬¡éƒ¨ç½²**å¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿ
2. **åç»­éƒ¨ç½²**é€šå¸¸ 2-3 åˆ†é’Ÿ
3. éƒ¨ç½²å¤±è´¥æ—¶æŸ¥çœ‹ **æ„å»ºæ—¥å¿—** äº†è§£è¯¦æƒ…
4. ç¯å¢ƒå˜é‡æ›´æ”¹åéœ€è¦ **é‡æ–°éƒ¨ç½²**

---

## ğŸ‰ å®Œæˆï¼

æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤é…ç½®åï¼Œä½ çš„ MiniMax2 é¡¹ç›®å°±å¯ä»¥åœ¨ Cloudflare Pages ä¸Šè¿è¡Œäº†ï¼

å¦‚æœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹æ„å»ºæ—¥å¿—æˆ–å‚è€ƒæ•…éšœæ’æŸ¥éƒ¨åˆ†ã€‚

